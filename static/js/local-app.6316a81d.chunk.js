(self.webpackChunkgdevelop_ide=self.webpackChunkgdevelop_ide||[]).push([[712],{80530:function(e,r,t){var n=t(74149).findGDJS,o=t(50057),a=o("path"),i=o("fs");e.exports={findJsExtensionModules:function(e){var r=e.filterExamples,t=e.onFindGDJS;return(t?t():n()).then((function(e){var t=e.gdjsRoot,n=a.join(t,"Runtime","Extensions");return console.info("Searching for JS extensions (file called JsExtension.js) in ".concat(n,"...")),new Promise((function(e,t){i.readdir(n,(function(o,u){if(o)return t(o);var s=u.filter((function(e){return!r||-1===e.indexOf("Example")}));Promise.all(s.map((function(e){return r=a.join(n,e),new Promise((function(e){var t=a.join(r,"JsExtension.js");i.stat(t,(function(r,n){return e(r?null:n.isFile()?t:null)}))}));var r}))).then((function(r){e(r.filter((function(e){return!!e})))}),t)}))}))}))}}},50790:function(e,r,t){var n=t(23570).loadExtension,o=t(50057),a=t(80530).findJsExtensionModules;e.exports=function(e){var r=e.gd,t=e.objectsEditorService,i=e.objectsRenderingService,u=e.filterExamples,s=e.onFindGDJS;return{loadAllExtensions:function(e){return a({filterExamples:u,onFindGDJS:s}).then((function(a){return Promise.all(a.map((function(a){var u=null;try{u=o(a,{rethrowException:!0})}catch(s){return{extensionModulePath:a,result:{message:"Unable to import extension. Please check for any syntax error or error that would prevent it from being run.",error:!0,rawError:s}}}return u?(t&&u.registerEditorConfigurations&&u.registerEditorConfigurations(t),i&&(u.registerInstanceRenderers&&u.registerInstanceRenderers(i),u.registerClearCache&&u.registerClearCache(i)),{extensionModulePath:a,result:n(e,r,r.JsPlatform.get(),u)}):{extensionModulePath:a,result:{error:!0,message:"Unknown error. Please check for any syntax error or error that would prevent it from being run."}}})))}),(function(e){throw console.error("Unable to find JS extensions modules"),e}))}}}},88947:function(e,r,t){"use strict";t.r(r),t.d(r,{create:function(){return ko}});var n=t(1413),o=t(28381),a=t(25782),i=t(2066),u=t(18375),s=(t(94492),t(13778),t(74165)),c=t(37762),l=t(15861),p=t(93433),f=t(36600),d=t(17037),h=t(33258),v=t(57974),m=t(50057),g=t.n(m),x=t(29439),w=t(79431),b=g()("fs"),y=g()("path");function P(e,r){return j.apply(this,arguments)}function j(){return(j=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i,u,l,p,f,d,h;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return");case 2:n=y.dirname(r.getProjectFile()),o=[],a=(0,c.Z)(t.values()),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=31;break}if(u=i.value,l=u.hasAnyEmbeddedResourceOutsideProjectFolder,p=u.embeddedResources,l){e.next=11;break}return e.abrupt("continue",29);case 11:f=(0,c.Z)(p.values()),e.prev=12,h=(0,s.Z)().mark((function e(){var r,t,a,i,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=d.value).isOutsideProjectFolder){e.next=3;break}return e.abrupt("return",1);case 3:t=y.basename(r.fullPath),a=y.extname(t),i=y.basename(t,a),u=(0,w.Z)(i,(function(e){var r=y.join(n,e)+a;return b.existsSync(r)})),c=y.join(n,u+a),r.resourceName=u+a,o.push(b.promises.copyFile(r.fullPath,c));case 10:case"end":return e.stop()}}),e)})),f.s();case 15:if((d=f.n()).done){e.next=21;break}return e.delegateYield(h(),"t0",17);case 17:if(!e.t0){e.next=19;break}return e.abrupt("continue",19);case 19:e.next=15;break;case 21:e.next=26;break;case 23:e.prev=23,e.t1=e.catch(12),f.e(e.t1);case 26:return e.prev=26,f.f(),e.finish(26);case 29:e.next=7;break;case 31:e.next=36;break;case 33:e.prev=33,e.t2=e.catch(5),a.e(e.t2);case 36:return e.prev=36,a.f(),e.finish(36);case 39:return e.abrupt("return",Promise.all(o));case 40:case"end":return e.stop()}}),e,null,[[5,33,36,39],[12,23,26,29]])})))).apply(this,arguments)}function k(e,r){var t,n=y.dirname(e.getProjectFile()),o=new Map,a=(0,c.Z)(r);try{for(a.s();!(t=a.n()).done;){var i,u=(0,x.Z)(t.value,2),s=u[0],l=u[1].embeddedResources,p={},f=(0,c.Z)(l.values());try{for(f.s();!(i=f.n()).done;){var h=i.value,v=h.resourceKind,m=h.resourceName,g=h.relPath,w=h.fullPath;m||(m=y.relative(n,w));var b=(0,d.h)(v);if(b){if(b.setName(m),b.setFile(m),p[g]=m,o.has(w)){var P=o.get(w);P&&P.mapping&&(b.setMetadata(JSON.stringify({embeddedResourcesMapping:P.mapping})),o.delete(w))}e.getResourcesManager().addResource(b)}}}catch(j){f.e(j)}finally{f.f()}o.set(s,{mapping:p})}}catch(j){a.e(j)}finally{a.f()}return o}function Z(e,r){return S.apply(this,arguments)}function S(){return(S=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i,u,l,p,f,d,h,m,g,x,w,P,j,k,Z,S;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,b.promises.readFile(t,"utf8");case 4:if(n=e.sent,e.prev=5,!(o=JSON.parse(n))||!o.__header__||"LDtk"!==o.__header__.app){e.next=16;break}a=y.dirname(t),i=new Map,u=!1,l=(0,c.Z)(o.defs.tilesets);try{for(l.s();!(p=l.n()).done;)(f=p.value).relPath&&(d=f.relPath,h=y.resolve(a,d),m=!(0,v.Te)(r,h),g={resourceKind:"image",relPath:d,fullPath:h,isOutsideProjectFolder:m},i.set(d,g),m&&(u=!0))}catch(s){l.e(s)}finally{l.f()}x=(0,c.Z)(o.levels);try{for(x.s();!(w=x.n()).done;)(P=w.value).bgRelPath&&(j=P.bgRelPath,k=y.resolve(a,j),Z=!(0,v.Te)(r,k),S={resourceKind:"image",relPath:j,fullPath:k,isOutsideProjectFolder:Z},i.set(P.bgRelPath,S),Z&&(u=!0))}catch(s){x.e(s)}finally{x.f()}return e.abrupt("return",{hasAnyEmbeddedResourceOutsideProjectFolder:u,embeddedResources:i});case 16:e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(5),console.error("Unable to read properly the data from file ".concat(t," for use as a tilemap - ignoring any potentially embedded resources.")),e.abrupt("return",null);case 22:case"end":return e.stop()}}),e,null,[[5,18]])})))).apply(this,arguments)}function E(){return(E=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return",null);case 2:return n=t.replace(".json",".atlas"),e.next=5,new Promise((function(e){b.promises.access(n,b.constants.F_OK).then((function(){return e(!0)})).catch((function(){return e(!1)}))}));case 5:if(e.sent){e.next=9;break}return console.error("Could not find an atlas file for Spine file ".concat(t,".")),e.abrupt("return",null);case 9:return o=y.basename(n),a=new Map,i=!(0,v.Te)(r,n),u={resourceKind:"atlas",relPath:o,fullPath:n,isOutsideProjectFolder:i},a.set(o,u),e.abrupt("return",{embeddedResources:a,hasAnyEmbeddedResourceOutsideProjectFolder:i});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function F(){return(F=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i,u,l,p,f,d,h,m,g;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(b&&y){e.next=2;break}return e.abrupt("return",null);case 2:return n=null,e.prev=3,e.next=6,b.promises.readFile(t,"utf8");case 6:n=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),console.error("Unable to read Spine Atlas file at path ".concat(t,":"),e.t0);case 12:if(n){e.next=14;break}return e.abrupt("return",null);case 14:if(o=/.*\.(png|jpeg|jpg)$/gm,a=n.match(o)){e.next=18;break}return e.abrupt("return",null);case 18:i=y.dirname(t),u=new Map,l=!1,p=(0,c.Z)(a);try{for(p.s();!(f=p.n()).done;)d=f.value,h=y.resolve(i,d),m=!(0,v.Te)(r,h),g={resourceKind:"image",relPath:d,fullPath:h,isOutsideProjectFolder:m},u.set(d,g),m&&(l=!0)}catch(s){p.e(s)}finally{p.f()}return e.abrupt("return",{embeddedResources:u,hasAnyEmbeddedResourceOutsideProjectFolder:l});case 24:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}var D={tilemap:Z,json:Z,spine:function(e,r){return E.apply(this,arguments)},atlas:function(e,r){return F.apply(this,arguments)}},C=t(40243),O=t(32484),_=t(15684),R=t(29343),N=g()("@electron/remote"),A=N?N.dialog:null,T=g()("path"),L=function(e){var r=e.options,t=e.onChooseResources,n=e.createNewResource;return(0,R.jsx)(h.L,{onChoose:function(e){var r=e.url,o=n();o.setFile(r),o.setName(T.basename(r)),o.setOrigin("gdevelop-asset-store",r),t([o])},resourceKind:r.resourceKind})},M=[].concat((0,p.Z)(d.Q.map((function(e){var r=e.kind,t=(e.displayName,e.fileExtensions),n=e.createNewResource,o=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(o){var a,u,p,f,d,h,m,g,x,w,b,y,j,Z,S,E,F,C,O,_,R,L,M;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.i18n,u=o.getLastUsedPath,p=o.setLastUsedPath,f=o.project,d=o.options,h=o.resourcesImporationBehavior,A){e.next=3;break}throw new Error("Electron dialog not supported in this environment.");case 3:return m=["openFile"],d.multiSelection&&m.push("multiSelections"),g=T.dirname(f.getProjectFile()),x=u(f,r)||g,w=N.getCurrentWindow(),e.next=10,A.showOpenDialog(w,{title:a._({id:"Choose a file"}),properties:m,filters:[{name:a._({id:"Supported files"}),extensions:t}],defaultPath:x});case 10:if(b=e.sent,(y=b.filePaths)&&y.length){e.next=14;break}return e.abrupt("return",[]);case 14:if(j=T.parse(y[0]).dir,p(f,r,j),Z=y.some((function(e){return!(0,v.Te)(f,e)})),S=new Map,E=D[r],F=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,c.Z)(r.embeddedResources.values()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=18;break}if(o=n.value,a=D[o.resourceKind]){e.next=8;break}return e.abrupt("continue",16);case 8:return i=o.fullPath,e.next=11,a(f,i);case 11:if(!(u=e.sent)){e.next=16;break}return S.set(i,u),e.next=16,F(u);case 16:e.next=3;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(1),t.e(e.t0);case 23:return e.prev=23,t.f(),e.finish(23);case 26:case"end":return e.stop()}}),e,null,[[1,20,23,26]])})));return function(r){return e.apply(this,arguments)}}(),!E){e.next=44;break}C=(0,c.Z)(y),e.prev=22,C.s();case 24:if((O=C.n()).done){e.next=36;break}return _=O.value,e.next=28,E(f,_);case 28:if(!(R=e.sent)){e.next=34;break}return e.next=32,F(R);case 32:S.set(_,R),R.hasAnyEmbeddedResourceOutsideProjectFolder&&(Z=!0);case 34:e.next=24;break;case 36:e.next=41;break;case 38:e.prev=38,e.t0=e.catch(22),C.e(e.t0);case 41:return e.prev=41,C.f(),e.finish(41);case 44:if(L=new Map,M=new Map,!Z){e.next=54;break}if(!("relative"!==h&&("import"===h||i.ZP.showConfirmDialog(a._({id:"This/these file(s) are outside the project folder. Would you like to make a copy of them in your project folder first (recommended)?"}))))){e.next=54;break}return e.next=51,(0,v.ZC)(f,y,L);case 51:return y=e.sent,e.next=54,P(f,S);case 54:return M=k(f,S),e.abrupt("return",y.map((function(e){var r=n();r.setFile(T.relative(g,e)),r.setName(T.relative(g,e));var t=L.has(e)?L.get(e):e;if(t){var o=M.get(t);o&&o.mapping&&r.setMetadata(JSON.stringify({embeddedResourcesMapping:o.mapping}))}return r})));case 56:case"end":return e.stop()}}),e,null,[[22,38,41,44]])})));return function(r){return e.apply(this,arguments)}}();return{name:"local-file-opener-"+r,displayName:{id:"Choose a file"},displayTab:"import",onlyForStorageProvider:"LocalFile",kind:r,selectResourcesHeadless:o,renderComponent:function(e){return(0,R.jsx)(C.x1,{justifyContent:"center",children:(0,R.jsx)(O.Z,{primary:!0,label:e.options.multiSelection?(0,R.jsx)(f.Trans,{id:"Choose one or more files"}):(0,R.jsx)(f.Trans,{id:"Choose a file"}),onClick:(0,l.Z)((0,s.Z)().mark((function r(){var t;return(0,s.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o({i18n:e.i18n,project:e.project,fileMetadata:e.fileMetadata,getStorageProvider:e.getStorageProvider,getLastUsedPath:e.getLastUsedPath,setLastUsedPath:e.setLastUsedPath,options:e.options,resourcesImporationBehavior:e.resourcesImporationBehavior});case 2:t=r.sent,e.onChooseResources(t);case 4:case"end":return r.stop()}}),r)})))})})}}}))),(0,p.Z)(d.Q.map((function(e){var r=e.kind,t=e.createNewResource;return{name:"upload-".concat(r),displayName:{id:"File(s) from your device"},displayTab:"import",onlyForStorageProvider:"Cloud",kind:r,renderComponent:function(e){return(0,R.jsx)(_.V,{createNewResource:t,onChooseResources:e.onChooseResources,options:e.options,fileMetadata:e.fileMetadata,getStorageProvider:e.getStorageProvider,automaticallyOpenInput:!!e.automaticallyOpenIfPossible},"url-chooser-".concat(r))}}}))),(0,p.Z)(d.Q.map((function(e){var r=e.kind,t=e.createNewResource;return{name:"resource-store-".concat(r),displayName:{id:"Choose from asset store"},displayTab:"standalone",kind:r,renderComponent:function(e){return(0,R.jsx)(L,{createNewResource:t,onChooseResources:e.onChooseResources,options:e.options},"resource-store-".concat(r))}}})))),I=M,U=t(4942),J=t(32705),W=t(62800),B=t(81303),G=g()("path"),H=g()("fs"),z=g()("electron"),K=z?z.ipcRenderer:null,X=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(K){e.next=2;break}throw new Error("Not supported.");case 2:return e.next=4,K.invoke("".concat(r,"-load"),t);case 4:return n=e.sent,e.abrupt("return",n);case 6:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),V=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,p;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.resourceNames,o=G.dirname(t.getProjectFile()),a=[],i=[],u=t.getResourcesManager(),n.forEach((function(e){if(u.hasResource(e)){var r=u.getResource(e).getFile();(0,v.PX)(r)?(0,v.Gu)(r)?console.error("Unsupported blob URL for a resource - ignoring it."):a.push({url:r,resourceName:e}):i.push({localFilePath:r,resourceName:e})}})),e.next=8,(0,B.R7)({urlContainers:a,onProgress:function(e,r){}});case 8:return c=e.sent,p=new Map,e.next=12,Promise.all(c.map(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.error,t=r.blob,n=r.item,!t){e.next=15;break}return e.prev=2,e.t0=p,e.t1=n.resourceName,e.next=7,(0,B.oT)(t);case 7:e.t2=e.sent,e.t3={dataUrl:e.t2},e.t0.set.call(e.t0,e.t1,e.t3),e.next=15;break;case 12:e.prev=12,e.t4=e.catch(2),console.error('Unable to read data from resource "'.concat(n.resourceName,'" - ignoring it.'),e.t4);case 15:case"end":return e.stop()}}),e,null,[[2,12]])})));return function(r){return e.apply(this,arguments)}}()));case 12:return e.next=14,Promise.all(i.map(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.localFilePath,n=r.resourceName,e.prev=1,e.next=4,H.promises.readFile(G.resolve(o,t));case 4:a=e.sent,p.set(n,{localFilePath:t,dataUrl:"data:text/plain;base64,"+a.toString("base64")}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.error('Unable to read local file "'.concat(t,'" - ignoring it.'),e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}()));case 14:return e.abrupt("return",n.map((function(e){var r=p.get(e);if(!r)return{name:e,dataUrl:""};var t=r.localFilePath;return{name:e,dataUrl:r.dataUrl,localFilePath:t}})));case 15:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Y=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,l,p,f,d,h;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.externalEditorName,n=r.defaultName,o=r.metadataKey,a=r.resourceKind,i=r.options,u=i.project,c=i.resourceNames,l=i.resourceManagementProps,e.next=4,V({project:u,resourceNames:c});case 4:return p=e.sent,f={singleFrame:i.extraOptions.singleFrame,externalEditorData:(0,J.Z2)(o,i.extraOptions.existingMetadata),fps:i.extraOptions.fps,isLooping:i.extraOptions.isLooping,name:i.extraOptions.name||c[0]||n,resources:p},(0,W.sY)(t),e.next=9,X(t,f);case 9:if(d=e.sent){e.next=12;break}return e.abrupt("return",null);case 12:return e.next=14,(0,J.Zv)({baseNameForNewResources:d.baseNameForNewResources,project:u,resources:d.resources,resourceKind:a});case 14:return h=e.sent,e.prev=15,e.next=18,l.onFetchNewlyAddedResources();case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(15),console.error("An error happened while fetching the newly added resources:",e.t0);case 23:return(0,J.$N)({modifiedResources:h,metadataKey:o,metadata:i.extraOptions.singleFrame?d.externalEditorData:null}),(0,J.TD)(h.map((function(e){return e.resource.getName()})),d.externalEditorData),e.abrupt("return",{resources:h.map((function(e){var r=e.resource,t=e.originalIndex;return{name:r.getName(),originalIndex:t}})),newName:d.baseNameForNewResources,newMetadata:(0,U.Z)({},o,d.externalEditorData)});case 26:case"end":return e.stop()}}),e,null,[[15,20]])})));return function(r){return e.apply(this,arguments)}}(),Q=[{name:"piskel-app",createDisplayName:{id:"Create with Piskel"},editDisplayName:{id:"Edit with Piskel"},kind:"image",edit:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y({options:r,externalEditorName:"piskel",defaultName:"New image",metadataKey:"pskl",resourceKind:"image"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},{name:"Jfxr",createDisplayName:{id:"Create with Jfxr"},editDisplayName:{id:"Edit with Jfxr"},kind:"audio",edit:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y({options:r,externalEditorName:"jfxr",defaultName:"New sound effect",metadataKey:"jfxr",resourceKind:"audio"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},{name:"Yarn",createDisplayName:{id:"Create with Yarn"},editDisplayName:{id:"Edit with Yarn"},kind:"json",edit:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y({options:r,externalEditorName:"yarn",defaultName:"New dialogue tree",metadataKey:"yarn",resourceKind:"json"});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}],$=Q,q=t(15671),ee=t(43144),re=t(60136),te=t(29388),ne=g()("os"),oe=function(){try{return ne.userInfo().uid}catch(e){return""}},ae=g()("fs-extra"),ie=g()("path"),ue=g()("os"),se=t.g.gd,ce=ie.posix||ie,le=(0,ee.Z)((function e(r){var t=this;(0,q.Z)(this,e),this._filesToDownload={},this.getAllUrlFilesIn=function(e){var r=ce.normalize(e).replace(/\\/g,"/");return Object.keys(t._filesToDownload).filter((function(e){return 0===e.indexOf(r)})).map((function(e){return{filePath:e,url:t._filesToDownload[e]}}))},this.mkDir=function(e){if(!(0,v.PX)(e)){try{ae.mkdirsSync(e)}catch(r){return console.error("mkDir("+e+") failed: "+r),!1}return!0}},this.dirExists=function(e){return!!(0,v.PX)(e)||ae.existsSync(e)},this.clearDir=function(e){try{ae.emptyDirSync(e)}catch(r){console.error("clearDir("+e+") failed: "+r)}},this.getTempDir=function(){return ie.join(ue.tmpdir(),"GDTMP-".concat(oe()))},this.fileNameFrom=function(e){return!t._downloadUrlsToLocalFiles&&(0,v.PX)(e)?e:ie.basename(e)},this.dirNameFrom=function(e){return ie.dirname(e).replace(/\\/g,"/")},this.makeAbsolute=function(e,r){return(0,v.PX)(e)?e:(t.isAbsolute(r)||(r=ie.resolve(r)),ie.resolve(r,ie.normalize(e)).replace(/\\/g,"/"))},this.makeRelative=function(e,r){return(0,v.PX)(e)?e:ie.relative(r,ie.normalize(e)).replace(/\\/g,"/")},this.isAbsolute=function(e){return!!(0,v.PX)(e)||(0===e.length||(e.length>0&&"/"===e.charAt(0)||e.length>1&&":"===e.charAt(1)))},this.copyFile=function(e,r){if((0,v.PX)(e))return!t._downloadUrlsToLocalFiles||((0,v.PX)(r)?(console.error("Destination can't be a URL in copyFile (from ".concat(e," to ").concat(r,").")),!1):(t._filesToDownload[ce.normalize(r)]=e,!0));try{e!==r&&ae.copySync(e,r)}catch(n){return console.error("copyFile("+e+", "+r+") failed: "+n),!1}return!0},this.writeToFile=function(e,r){try{ae.outputFileSync(e,r)}catch(t){return console.error("writeToFile("+e+", ...) failed: "+t),!1}return!0},this.readFile=function(e){try{return ae.readFileSync(e).toString()}catch(r){return console.error("readFile("+e+") failed: "+r),""}},this.readDir=function(e,r){r=r.toUpperCase();var t=new se.VectorString;try{ae.existsSync(e)&&ae.readdirSync(e).forEach((function(n){0!==r.length&&-1===n.toUpperCase().indexOf(r,n.length-r.length)||t.push_back(e+"/"+n)}))}catch(n){console.error("readDir("+e+","+r+") failed: "+n)}return t},this.fileExists=function(e){var r=ce.normalize(e);if(!!t._filesToDownload[r])return!0;try{return ae.statSync(e).isFile()}catch(n){return!1}},this._downloadUrlsToLocalFiles=!!r&&r.downloadUrlsToLocalFiles})),pe=le,fe=t(74149),de=t(1773),he=t(67835),ve=t(86278),me=t(78081),ge=t(75087),xe=t(94553),we=t(6996),be=function(e){var r=e.url,t=e.open,n=e.error,o=e.onExport,a=e.onClose,i=e.onRunPreviewLocally,u=(0,we.U)().isMobile;if(!t)return null;var s=r?"http://".concat(r):"";return(0,R.jsxs)(de.ZP,{title:(0,R.jsx)(f.Trans,{id:"Preview"}),actions:[(0,R.jsx)(he.Z,{label:(0,R.jsx)(f.Trans,{id:"Close"}),primary:!0,onClick:a},"close")],secondaryActions:[o&&(0,R.jsx)(he.Z,{label:(0,R.jsx)(f.Trans,{id:"Export game"}),onClick:o},"export"),(0,R.jsx)(he.Z,{label:(0,R.jsx)(f.Trans,{id:"Run on this computer"}),onClick:i},"run-preview-locally")],open:t,onRequestClose:a,maxWidth:"sm",children:[n&&(0,R.jsx)(C.x1,{children:(0,R.jsx)(ve.Z,{children:(0,R.jsx)(f.Trans,{id:"Unable to start the server for the preview! Make sure that you are authorized to run servers on this computer. Otherwise, use classic preview to test your game."})})}),!n&&!r&&(0,R.jsx)(me.Z,{}),!n&&r&&(0,R.jsxs)("div",{children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(ve.Z,{children:(0,R.jsx)(f.Trans,{id:"Your preview is ready! On your mobile or tablet, open your browser and enter in the address bar:"})})}),(0,R.jsx)(ge.Z,{url:r}),s&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(ve.Z,{children:(0,R.jsx)(f.Trans,{id:"Or flash this QR code:"})})}),(0,R.jsx)(C.x1,{justifyContent:"center",children:(0,R.jsx)(xe.Z,{url:s,size:u?100:150})})]}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(ve.Z,{children:(0,R.jsx)(f.Trans,{id:"Please note that your device should be connected on the same network as this computer."})})})]})]})},ye=t(25842),Pe=t.n(ye),je=t(79987),ke=g()("electron"),Ze=ke?ke.ipcRenderer:null,Se="stopped",Ee=null,Fe=[],De=[],Ce={startServer:function(){if(!Ze)return Promise.reject();if("started"===Se)return Promise.resolve();var e=new Promise((function(e,r){var t=!1;Se="stopped",Ee=null,Ze&&(Ze.removeAllListeners("debugger-send-message-done"),Ze.removeAllListeners("debugger-error-received"),Ze.removeAllListeners("debugger-connection-closed"),Ze.removeAllListeners("debugger-connection-opened"),Ze.removeAllListeners("debugger-connection-errored"),Ze.removeAllListeners("debugger-start-server-done"),Ze.removeAllListeners("debugger-message-received")),Ze.on("debugger-error-received",(function(e,n){t||(r(n),t=!0),Fe.forEach((function(e){return(0,e.onErrorReceived)(n)}))})),Ze.on("debugger-connection-closed",(function(e,r){var t=r.id,n=De.indexOf(t);-1!==n&&De.splice(n,1),Fe.forEach((function(e){return(0,e.onConnectionClosed)({id:t,debuggerIds:De})}))})),Ze.on("debugger-connection-opened",(function(e,r){var t=r.id;De.push(t),Fe.forEach((function(e){return(0,e.onConnectionOpened)({id:t,debuggerIds:De})}))})),Ze.on("debugger-connection-errored",(function(e,r){var t=r.id,n=r.errorMessage;Fe.forEach((function(e){return(0,e.onConnectionErrored)({id:t,errorMessage:n})}))})),Ze.on("debugger-start-server-done",(function(r,n){var o=n.address;console.info("Local preview debugger started"),Se="started",Ee=o,t||(e(),t=!0),Fe.forEach((function(e){return(0,e.onServerStateChanged)()}))})),Ze.on("debugger-message-received",(function(e,r){var t=r.id,n=r.message;console.info("Processing message received for debugger");try{var o=JSON.parse(n);Fe.forEach((function(e){return(0,e.onHandleParsedMessage)({id:t,parsedMessage:o})}))}catch(a){console.warn("Error while parsing message received from debugger client:",a)}})),Ze.send("debugger-start-server")})),r=new Promise((function(e,r){setTimeout((function(){r(new Error("Debugger server not started or errored after 5s - aborting."))}),5e3)}));return Promise.race([e,r])},sendMessage:function(e,r){Ze&&("stopped"!==Se?Ze.send("debugger-send-message",{id:e,message:JSON.stringify(r)}):console.error("Cannot send message when debugger server is stopped."))},getServerState:function(){return Se},getExistingDebuggerIds:function(){return De},registerCallbacks:function(e){return Fe.push(e),function(){var r=Fe.indexOf(e);-1!==r&&Fe.splice(r,1)}}},Oe=g()("electron"),_e=g()("path"),Re=Oe?Oe.ipcRenderer:null,Ne=t.g.gd,Ae=function(e){(0,re.Z)(t,e);var r=(0,te.Z)(t);function t(){var e;(0,q.Z)(this,t);for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return(e=r.call.apply(r,[this].concat(o))).canDoNetworkPreview=function(){return!0},e.canDoHotReload=function(){return!0},e.state={networkPreviewDialogOpen:!1,networkPreviewHost:null,networkPreviewPort:null,networkPreviewError:null,previewGamePath:null,previewBrowserWindowOptions:null,hotReloadsCount:0,hideMenuBar:!0,alwaysOnTop:!0},e._networkPreviewSubscriptionChecker=null,e._hotReloadSubscriptionChecker=null,e._openPreviewBrowserWindow=function(){var r=e.state,t=r.previewGamePath,n=r.previewBrowserWindowOptions;n&&t&&Re&&Re.invoke("preview-open",{previewBrowserWindowOptions:n,previewGameIndexHtmlPath:"file://".concat(t,"/index.html"),alwaysOnTop:e.state.alwaysOnTop,hideMenuBar:e.state.hideMenuBar})},e.closePreview=function(e){Re&&Re.invoke("preview-close",{windowId:e})},e._openPreviewWindow=function(r,t,n){e.setState({previewBrowserWindowOptions:{width:r.getGameResolutionWidth(),height:r.getGameResolutionHeight(),useContentSize:!0,title:"Preview of ".concat(r.getName()),backgroundColor:"#000000",webPreferences:{webSecurity:!1,nodeIntegration:!0,contextIsolation:!1}},previewGamePath:t,hideMenuBar:!n.getIsMenuBarHiddenInPreview(),alwaysOnTop:n.getIsAlwaysOnTopInPreview()},(function(){if(n.networkPreview){if(!Re)return;Re.removeAllListeners("serve-folder-done"),Re.removeAllListeners("local-network-ips"),Re.on("serve-folder-done",(function(r,t,n){t?e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:null,networkPreviewHost:null,networkPreviewError:t}):e.setState({networkPreviewDialogOpen:!0,networkPreviewPort:n.port}),setTimeout((function(){return e._checkSubscriptionForNetworkPreview()}))})),Re.on("local-network-ip",(function(r,t){e.setState({networkPreviewHost:t})})),Re.send("serve-folder",{root:t}),Re.send("get-local-network-ip")}else e._openPreviewBrowserWindow()}))},e._prepareExporter=function(){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!1}),n=Pe()(new Ne.AbstractFileSystemJS,t);return{outputDir:_e.join(n.getTempDir(),"preview"),exporter:new Ne.Exporter(n,r),gdjsRoot:r}}))},e.launchPreview=function(r){var t=r.project,n=r.layout,o=r.externalLayout;return e.getPreviewDebuggerServer().startServer().catch((function(e){console.error("Unable to start the Debugger Server for the preview:",e)})).then((function(){return e._prepareExporter()})).then((function(a){var u=a.outputDir,s=a.exporter,c=a.gdjsRoot;!function(e,r){var t=performance.now();e(),r(performance.now()-t)}((function(){var a=new Ne.PreviewExportOptions(t,u);a.setIsDevelopmentEnvironment(i.ZP.isDev()),a.setLayoutName(n.getName()),o&&a.setExternalLayoutName(o.getName());var l=Ee;l&&a.useWebsocketDebuggerClientWithServerAddress(l.address,""+l.port);var p=e.props.getIncludeFileHashs();for(var f in p){var d=p[f];a.setIncludeFileHash(f,d)}a.setElectronRemoteRequirePath(_e.join(c,"../preview_node_modules","@electron/remote","renderer/index.js"));var h=e.getPreviewDebuggerServer().getExistingDebuggerIds(),v=r.hotReload&&!!h.length;a.setProjectDataOnlyExport(v&&r.projectDataOnlyExport),a.setFullLoadingScreen(r.fullLoadingScreen),r.fallbackAuthor&&a.setFallbackAuthor(r.fallbackAuthor.id,r.fallbackAuthor.username),s.exportProjectForPixiPreview(a),a.delete(),s.delete(),v?(h.forEach((function(r){e.getPreviewDebuggerServer().sendMessage(r,{command:"hotReload"})})),e.state.hotReloadsCount%16===0&&e._hotReloadSubscriptionChecker&&e._hotReloadSubscriptionChecker.checkUserHasSubscription(),e.setState((function(e){return{hotReloadsCount:e.hotReloadsCount+1}}))):e._openPreviewWindow(t,u,r)}),(function(e){return console.info("Preview took ".concat(e,"ms"))}))}))},e._checkSubscriptionForNetworkPreview=function(){return!e._networkPreviewSubscriptionChecker||e._networkPreviewSubscriptionChecker.checkUserHasSubscription()},e}return(0,ee.Z)(t,[{key:"getPreviewDebuggerServer",value:function(){return Ce}},{key:"render",value:function(){var e=this,r=this.state,t=r.networkPreviewDialogOpen,n=r.networkPreviewHost,a=r.networkPreviewPort,i=r.networkPreviewError;return(0,R.jsxs)(o.Fragment,{children:[(0,R.jsx)(je.Z,{ref:function(r){return e._networkPreviewSubscriptionChecker=r},onChangeSubscription:function(){return e.setState({networkPreviewDialogOpen:!1})},id:"Preview over wifi",title:(0,R.jsx)(f.Trans,{id:"Preview over wifi"}),mode:"try"}),(0,R.jsx)(je.Z,{ref:function(r){return e._hotReloadSubscriptionChecker=r},id:"Hot reloading",title:(0,R.jsx)(f.Trans,{id:"Live preview (apply changes to the running preview)"}),mode:"try"}),(0,R.jsx)(be,{open:t,url:n&&a?"".concat(n,":").concat(a):null,error:i,onClose:function(){return e.setState({networkPreviewDialogOpen:!1})},onExport:this.props.onExport,onRunPreviewLocally:this._openPreviewBrowserWindow})]})}}]),t}(o.Component),Te=t(73818),Le=t(76349),Me=t(19431),Ie=g()("electron"),Ue=Ie?Ie.shell:null,Je=t.g.gd,We="local-cordova",Be={name:We,packageNameWarningType:"mobile",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return"done"!==e.exportStep?(0,R.jsxs)(C.sg,{noMargin:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(C.sg,{noMargin:!0,children:(0,R.jsx)(Le.if,{})})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(Te.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]}):null},renderExportFlow:function(e){return(0,R.jsx)(Le.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:We}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Je.AbstractFileSystemJS,t);return{exporter:new Je.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,(i=new Je.ExportOptions(r.project,r.exportState.outputDir)).setTarget("cordova"),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState,t=function(){Ue&&Ue.openPath(r.outputDir)};return(0,R.jsx)(Le.Eg,{renderGameButton:function(){return(0,R.jsx)(O.Z,{label:(0,R.jsx)(f.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},Ge=t(41426),He=g()("electron"),ze=He?He.shell:null,Ke=t.g.gd,Xe="local-electron",Ve={name:Xe,packageNameWarningType:"desktop",getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return"done"!==e.exportStep?(0,R.jsxs)(C.sg,{noMargin:!0,expand:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(C.sg,{noMargin:!0,children:(0,R.jsx)(Ge.if,{})})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(Te.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]}):null},renderExportFlow:function(e){return(0,R.jsx)(Ge.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Xe}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Ke.AbstractFileSystemJS,t);return{exporter:new Ke.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,(i=new Ke.ExportOptions(r.project,r.exportState.outputDir)).setTarget("electron"),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState,t=function(){ze&&ze.openPath(r.outputDir)};return(0,R.jsx)(Ge.Eg,{renderGameButton:function(){return(0,R.jsx)(O.Z,{label:(0,R.jsx)(f.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},Ye=t(39935),Qe=t(95644),$e=g()("electron"),qe=$e?$e.shell:null,er=t.g.gd,rr="local-html5",tr={name:rr,getInitialExportState:function(e){return{outputDir:e.getLastCompilationDirectory()}},canLaunchBuild:function(e){return!!e.outputDir},isNavigationDisabled:function(){return!1},renderTutorial:function(){return(0,R.jsx)(Qe.Z,{tutorialId:"export-to-itch"})},renderHeader:function(e){var r=e.project,t=e.exportState,n=e.updateExportState;return"done"!==e.exportStep?(0,R.jsxs)(C.sg,{noMargin:!0,expand:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(Ye.if,{})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(Te.Z,{type:"export",value:t.outputDir,defaultPath:r.getLastCompilationDirectory(),onChange:function(e){n((function(){return{outputDir:e}})),r.setLastCompilationDirectory(e)},fullWidth:!0})})]}):null},renderExportFlow:function(e){return(0,R.jsx)(Ye.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:rr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new er.AbstractFileSystemJS,t);return{exporter:new er.Exporter(n,r),localFileSystem:t}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=new er.ExportOptions(r.project,r.exportState.outputDir),n&&i.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(i),i.delete(),o.delete(),e.abrupt("return",{urlFiles:a.getAllUrlFilesIn(r.exportState.outputDir)});case 7:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:n,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",null);case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){return Promise.resolve(null)},renderDoneFooter:function(e){var r=e.exportState;return(0,R.jsx)(Ye.Eg,{renderGameButton:function(){return(0,R.jsx)(O.Z,{primary:!0,onClick:function(){qe&&qe.openPath(r.outputDir)},label:(0,R.jsx)(f.Trans,{id:"Open the exported game folder"})})}})}},nr=t(29277),or=g()("electron"),ar=g()("@electron/remote"),ir=ar?ar.dialog:null,ur={container:{position:"relative",display:"flex",alignItems:"baseline"},button:{marginLeft:10},textField:{flex:1}},sr=function(e){var r=e.value,t=e.onChange,o=e.title,a=e.message,i=e.defaultPath,u=e.fullWidth,c=e.filters,p=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){var r,n,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ir&&or){e.next=2;break}return e.abrupt("return");case 2:return r=ar.getCurrentWindow(),e.next=5,ir.showSaveDialog(r,{title:o,filters:c,message:a,defaultPath:i});case 5:n=e.sent,u=n.filePath,t(u||"");case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,R.jsxs)("div",{style:(0,n.Z)((0,n.Z)({},ur.container),{},{width:u?"100%":void 0}),children:[(0,R.jsx)(nr.ZP,{margin:"dense",style:ur.textField,type:"text",translatableHintText:{id:"Choose a file"},value:r,onChange:function(e,r){return t(r)}}),(0,R.jsx)(he.Z,{label:(0,R.jsx)(f.Trans,{id:"Choose"}),style:ur.button,onClick:p})]})};function cr(e){var r=!1,t=void 0;return function(){return r||(console.info("Lazy loading ".concat(e,"...")),t=g()(e),r=!0),t}}var lr=g()("fs"),pr=cr("archiver"),fr=function(e){var r=e.path,t=e.outputFilename,n=e.sizeLimit,o=pr();return new Promise((function(e,a){if(!lr||!o)return a(new Error("Archiver unavailable"));var i=lr.createWriteStream(t),u=o("zip",{zlib:{level:9}});i.on("close",(function(){var r=u.pointer();if(console.log("Archive written at ".concat(t,", ").concat(r," total bytes.")),n&&r>n){var o=Math.round(r/1e6);a(new Error("Archive is of size ".concat(o," MB, which is above the limit allowed of ").concat(n/1e6," MB.")))}e(t)})),u.on("error",(function(e){a(e)})),u.pipe(i),u.directory(r,!1),u.finalize()}))},dr=t(15745),hr=g()("path"),vr=g()("electron"),mr=g()("@electron/remote"),gr=mr?mr.app:null,xr=vr?vr.shell:null,wr=t.g.gd,br="local-facebook-instant-games",yr={name:br,getInitialExportState:function(e){return{archiveOutputFilename:gr?hr.join(gr.getPath("documents"),"fb-instant-game.zip"):""}},canLaunchBuild:function(e){return!!e.archiveOutputFilename},isNavigationDisabled:function(){return!1},renderHeader:function(e){e.project;var r=e.exportState,t=e.updateExportState;return"done"!==e.exportStep?(0,R.jsxs)(C.sg,{noMargin:!0,expand:!0,children:[(0,R.jsx)(C.x1,{children:(0,R.jsx)(dr.if,{})}),(0,R.jsx)(C.x1,{children:(0,R.jsx)(sr,{title:"Facebook Instant Games export zip file",message:"Choose where to save the exported file for Facebook Instant Games",filters:[{name:"Compressed file for Facebook Instant Games",extensions:["zip"]}],value:r.archiveOutputFilename,defaultPath:gr?gr.getPath("documents"):"",onChange:function(e){return t((function(){return{archiveOutputFilename:e}}))},fullWidth:!0})})]}):null},renderExportFlow:function(e){return(0,R.jsx)(dr.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:br}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new wr.AbstractFileSystemJS,t),o=new wr.Exporter(n,r),a=hr.join(n.getTempDir(),"FacebookInstantGamesExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new wr.ExportOptions(r.project,i)).setTarget("facebookInstantGames"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir;return fr({path:t,outputFilename:e.exportState.archiveOutputFilename})},renderDoneFooter:function(e){var r=e.exportState,t=function(){xr&&hr&&xr.openPath(hr.dirname(r.archiveOutputFilename))};return(0,R.jsx)(dr.Eg,{renderGameButton:function(){return(0,R.jsx)(O.Z,{label:(0,R.jsx)(f.Trans,{id:"Open folder"}),primary:!0,onClick:t},"open")}})}},Pr=t(10959),jr=g()("electron"),kr=jr?jr.ipcRenderer:null,Zr=function(e,r,t){return kr?(kr.removeAllListeners("local-file-upload-progress"),kr.removeAllListeners("local-file-upload-done"),new Promise((function(n,o){kr.on("local-file-upload-progress",(function(e,r,n){t(r,n)})),kr.on("local-file-upload-done",(function(e,r){if(r)return o(r);n()})),kr.send("local-file-upload",e,r)}))):Promise.reject("No support for local file upload")},Sr=t(61421),Er=g()("path"),Fr=g()("os"),Dr=t.g.gd,Cr="local-online-cordova",Or={name:Cr,onlineBuildType:"cordova-build",limitedBuilds:!0,packageNameWarningType:"mobile",getInitialExportState:function(){return{targets:["androidApk"],keystore:"new",signingDialogOpen:!1}},canLaunchBuild:function(e,r,t){return r||""===t},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,R.jsx)(Sr.s_,(0,n.Z)({},e))},shouldSuggestBumpingVersionNumber:function(){return!0},renderExportFlow:function(e){return(0,R.jsx)(Sr.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Cr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Dr.AbstractFileSystemJS,t),o=new Dr.Exporter(n,r),a=Er.join(n.getTempDir(),"OnlineCordovaExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new Dr.ExportOptions(r.project,i)).setTarget("cordova"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Fr.tmpdir();return fr({path:t,outputFilename:Er.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,Pr.Zi)().then((function(t){return Zr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o,a){var i=r.getAuthorizationHeader,u=r.firebaseUser;return u?(0,Pr.$C)(i,u.uid,t,e.targets,e.keystore,n,o,a):Promise.reject(new Error("User is not authenticated"))}},_r=t(82828),Rr=g()("path"),Nr=g()("os"),Ar=t.g.gd,Tr="local-online-cordova-ios",Lr={name:Tr,onlineBuildType:"cordova-ios-build",limitedBuilds:!0,packageNameWarningType:"mobile",getInitialExportState:function(){return{targets:["iosAppStore"],signing:null}},canLaunchBuild:function(e,r,t){return(r||""===t)&&!!e.signing},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,R.jsx)(_r.s_,(0,n.Z)({},e))},shouldSuggestBumpingVersionNumber:function(){return!0},renderExportFlow:function(e){return(0,R.jsx)(_r.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Tr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Ar.AbstractFileSystemJS,t),o=new Ar.Exporter(n,r),a=Rr.join(n.getTempDir(),"OnlineCordovaExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new Ar.ExportOptions(r.project,i)).setTarget("cordova"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Nr.tmpdir();return fr({path:t,outputFilename:Rr.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,Pr.Zi)().then((function(t){return Zr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o,a){var i=r.getAuthorizationHeader,u=r.profile;return u?e.signing?(0,Pr.NZ)(i,u.id,t,e.targets,e.signing,n,o,a):Promise.reject(new Error("Signing options not set up")):Promise.reject(new Error("User is not authenticated"))}},Mr=t(87335),Ir=g()("path"),Ur=g()("os"),Jr=t.g.gd,Wr="local-online-electron",Br={name:Wr,onlineBuildType:"electron-build",limitedBuilds:!0,packageNameWarningType:"desktop",getInitialExportState:function(){return{targets:["winExe"]}},canLaunchBuild:function(e,r,t){return!!e.targets.length&&(r||""===t)},isNavigationDisabled:function(e,r){return!r&&["register","export","resources-download","compress","upload"].includes(e)},renderHeader:function(e){return(0,R.jsx)(Mr.s_,(0,n.Z)({},e))},renderExportFlow:function(e){return(0,R.jsx)(Mr.yg,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Wr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Jr.AbstractFileSystemJS,t),o=new Jr.Exporter(n,r),a=Ir.join(n.getTempDir(),"OnlineElectronExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,(u=new Jr.ExportOptions(r.project,i)).setTarget("electron"),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 8:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Ur.tmpdir();return fr({path:t,outputFilename:Ir.join(n,"game-archive.zip")})},launchUpload:function(e,r){return(0,Pr.Zi)().then((function(t){return Zr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o,a){var i=r.getAuthorizationHeader,u=r.firebaseUser;return u?(0,Pr.ch)(i,u.uid,t,e.targets,n,o,a):Promise.reject(new Error("User is not authenticated"))}},Gr=t(96516),Hr=t(4615),zr=g()("path"),Kr=g()("os"),Xr=t.g.gd,Vr="local-online-web",Yr={name:Vr,onlineBuildType:"web-build",getInitialExportState:function(){return null},canLaunchBuild:function(e,r,t){return r||""===t||"done"===t},isNavigationDisabled:function(e,r){return!r&&!["","done"].includes(e)},renderHeader:function(){return(0,R.jsx)(Gr.if,{})},renderExportFlow:function(e){return(0,R.jsx)(Hr.Z,(0,n.Z)((0,n.Z)({},e),{},{exportPipelineName:Vr}))},prepareExporter:function(e){return(0,fe.findGDJS)().then((function(e){var r=e.gdjsRoot;console.info("GDJS found in ",r);var t=new pe({downloadUrlsToLocalFiles:!0}),n=Pe()(new Xr.AbstractFileSystemJS,t),o=new Xr.Exporter(n,r),a=zr.join(n.getTempDir(),"OnlineWebExport");return n.mkDir(a),n.clearDir(a),{exporter:o,localFileSystem:t,temporaryOutputDir:a}}))},launchExport:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i,u;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.exporter,a=t.localFileSystem,i=t.temporaryOutputDir,u=new Xr.ExportOptions(r.project,i),n&&u.setFallbackAuthor(n.id,n.username),o.exportWholePixiProject(u),u.delete(),o.delete(),e.abrupt("return",{temporaryOutputDir:i,urlFiles:a.getAllUrlFilesIn(i)});case 7:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),launchResourcesDownload:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.temporaryOutputDir,o=t.urlFiles,e.next=3,(0,Me.t)({urlContainers:o,onProgress:r.updateStepProgress,throwIfAnyError:!0});case 3:return e.abrupt("return",{temporaryOutputDir:n});case 4:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),launchCompression:function(e,r){var t=r.temporaryOutputDir,n=Kr.tmpdir();return fr({path:t,outputFilename:zr.join(n,"game-archive.zip"),sizeLimit:25e7})},launchUpload:function(e,r){return(0,Pr.Zi)().then((function(t){return Zr(r,t,e.updateStepProgress).then((function(){return t.key}))}))},launchOnlineBuild:function(e,r,t,n,o,a){var i=r.getAuthorizationHeader,u=r.firebaseUser;return u?(0,Pr.Bc)(i,u.uid,t,n,o,a):Promise.reject(new Error("User is not authenticated"))}},Qr=(0,n.Z)((0,n.Z)({},Gr.O1),{},{exportPipeline:Yr}),$r=[(0,n.Z)((0,n.Z)({},Ye.BN),{},{exportPipeline:tr}),(0,n.Z)((0,n.Z)({},Sr.Vf),{},{exportPipeline:Or}),(0,n.Z)((0,n.Z)({},_r.Y$),{},{exportPipeline:Lr}),(0,n.Z)((0,n.Z)({},Mr.OL),{},{exportPipeline:Br}),(0,n.Z)((0,n.Z)({},dr.xu),{},{exportPipeline:yr})],qr=[(0,n.Z)((0,n.Z)({},Ye.BN),{},{exportPipeline:tr}),(0,n.Z)((0,n.Z)({},Le.VU),{},{exportPipeline:Be}),(0,n.Z)((0,n.Z)({},Ge.c8),{},{exportPipeline:Ve})],et=t(76288),rt=t(36559),tt=t(36262),nt=g()("electron"),ot=g()("@electron/remote"),at=ot?ot.app:null,it=nt?nt.ipcRenderer:null,ut=function(e){var r=e.ipcEvent,t=e.callback,n=e.shouldApply;o.useEffect((function(){if(it&&n){var e=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.apply(void 0,n)};return it.on(r,e),function(){return it.removeListener(r,e)}}}),[r,t,n])},st=function(e){var r=e.event,t=e.callback;o.useEffect((function(){if(at){var e=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];return t.apply(void 0,n)};return at.on(r,e),function(){return at.removeListener(r,e)}}}),[r,t])},ct=function(e){if(!e)return!1;var r=e.toLowerCase();return r.startsWith("gdevelop")&&"gdevelop dialogue tree editor (yarn)"!==r&&"gdevelop sound effects editor (jfxr)"!==r&&"gdevelop image editor (piskel)"!==r},lt=function(e){var r=e.props,t=e.callbacks,n=e.extraCallbacks,a=r.i18n,i=r.project,u=r.canSaveProjectAs,s=r.recentProjectFiles,c=r.shortcutMap,l=r.isApplicationTopLevelMenu,p=n.onClosePreview,f=a.language,d=o.useState(!0),h=(0,x.Z)(d,2),v=h[0],m=h[1],g=o.useState(ot.getCurrentWindow().id),w=(0,x.Z)(g,2),b=w[0],y=w[1],P=!v&&p?function(){return p(b)}:null,j=o.useContext(tt.ZP).values.useShortcutToClosePreviewWindow;st({event:"browser-window-focus",callback:function(e){y(e.id),m(ct(e.title))}}),st({event:"browser-window-blur",callback:function(e){m(!ct(e.title))}}),ut({ipcEvent:"main-menu-open",callback:t.onChooseProject,shouldApply:v}),ut({ipcEvent:"main-menu-open-recent",callback:t.onOpenRecentFile,shouldApply:v}),ut({ipcEvent:"main-menu-save",callback:t.onSaveProject,shouldApply:v}),ut({ipcEvent:"main-menu-save-as",callback:t.onSaveProjectAs,shouldApply:v}),ut({ipcEvent:"main-menu-show-version-history",callback:t.onShowVersionHistory,shouldApply:v}),ut({ipcEvent:"main-menu-close",callback:j&&P?P:t.onCloseProject,shouldApply:!(!j||!P)||v}),ut({ipcEvent:"main-menu-close-app",callback:t.onCloseApp,shouldApply:v}),ut({ipcEvent:"main-menu-export",callback:t.onExportProject,shouldApply:v}),ut({ipcEvent:"main-menu-invite-collaborators",callback:t.onInviteCollaborators,shouldApply:v}),ut({ipcEvent:"main-menu-create-template",callback:t.onCreateProject,shouldApply:v}),ut({ipcEvent:"main-menu-create-blank",callback:t.onCreateBlank,shouldApply:v}),ut({ipcEvent:"main-menu-open-project-manager",callback:t.onOpenProjectManager,shouldApply:v}),ut({ipcEvent:"main-menu-open-home-page",callback:t.onOpenHomePage,shouldApply:v}),ut({ipcEvent:"main-menu-open-debugger",callback:t.onOpenDebugger,shouldApply:v}),ut({ipcEvent:"main-menu-open-about",callback:t.onOpenAbout,shouldApply:v}),ut({ipcEvent:"main-menu-open-preferences",callback:t.onOpenPreferences,shouldApply:v}),ut({ipcEvent:"main-menu-open-language",callback:t.onOpenLanguage,shouldApply:v}),ut({ipcEvent:"main-menu-open-profile",callback:t.onOpenProfile,shouldApply:v}),ut({ipcEvent:"update-status",callback:t.setElectronUpdateStatus,shouldApply:!0}),o.useEffect((function(){it&&it.send("set-main-menu",(0,rt.c)({project:i,canSaveProjectAs:u,i18n:a,recentProjectFiles:s,shortcutMap:c,isApplicationTopLevelMenu:l}))}),[a,f,i,u,s,c,l]);var k=t.onOpenRecentFile;return(0,et.gT)("OPEN_RECENT_PROJECT",!0,{generateOptions:o.useCallback((function(){return s.map((function(e){return{text:e.fileMetadata.fileIdentifier,handler:function(){return k(e)}}}))}),[k,s])}),null},pt=t(50790),ft=t.n(pt),dt=t(91479),ht=t.n(dt),vt=g()("path"),mt=g()("os"),gt=g()("fs"),xt=function(e){var r=e.onWriteFile,t=vt.join(mt.tmpdir(),"GDGeneratedEventsFunctions-"+oe());gt.mkdir(t,(function(e){e&&"EEXIST"!==e.code&&console.error("Unable to create the directory where to output events functions generated code: ",e)}));var n=function(e){return"".concat(t,"/").concat(ht()(e),".js")};return{getIncludeFileFor:function(e){return n(e)},writeFunctionCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),gt.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))},writeBehaviorCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),gt.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))},writeObjectCode:function(e,t){return new Promise((function(o,a){var i=n(e);r({includeFile:i,content:t}),gt.writeFile(i,t,(function(e){if(e)return a(e);o()}))}))}}},wt=t(64469),bt=t(90505),yt=t(5712),Pt=t(41006),jt=g()("fs-extra"),kt=g()("path"),Zt=g()("@electron/remote"),St=Zt?Zt.dialog:null,Et=(0,ee.Z)((function e(){(0,q.Z)(this,e)}));Et.chooseEventsFunctionExtensionFile=function(e){if(!St)return Promise.reject("Not supported");var r=Zt.getCurrentWindow();return St.showSaveDialog(r,{title:"Export an extension of the project",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}],defaultPath:e||"Extension.json"}).then((function(e){var r=e.filePath;return r||null}))},Et.writeEventsFunctionsExtension=function(e,r){return function(e,r){if(!jt)return Promise.reject(new Error("Filesystem is not supported."));try{var t=JSON.stringify(e,null,2);return jt.ensureDir(kt.dirname(r)).then((function(){return new Promise((function(e,n){jt.writeFile(r,t,(function(r){return r?n(r):e()}))}))}))}catch(n){return Promise.reject(n)}}((0,Pt.XH)(e),r).catch((function(e){throw console.error("Unable to write the events function extension:",e),e}))};var Ft=g()("fs"),Dt=g()("@electron/remote"),Ct=Dt?Dt.dialog:null,Ot=(0,ee.Z)((function e(){(0,q.Z)(this,e)}));Ot.chooseEventsFunctionExtensionFile=function(){if(!Ct)return Promise.reject("Not supported");var e=Dt.getCurrentWindow();return Ct.showOpenDialog(e,{title:"Import an extension in the project",properties:["openFile"],message:"Choose an extension file to import (.json file)",filters:[{name:'GDevelop 5 "events based" extension',extensions:["json"]}]}).then((function(e){var r=e.filePaths;return r&&r.length?r[0]:null}))},Ot.readEventsFunctionExtensionFile=function(e){return function(e){return Ft?new Promise((function(r,t){Ft.readFile(e,{encoding:"utf8"},(function(n,o){if(n)return t(n);try{var a=JSON.parse(o);return r(a)}catch(i){return t(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")}(e)};var _t,Rt,Nt=t(56924),At=function(e,r){var t=r.isReferenceMagicPropertyName,n=r.getReferencePartialObject,o=r.maxUnsplitDepth;return function e(r,a){if(void 0!==o&&a>=o)return Promise.resolve();if(null!==r&&"object"===typeof r){var i=Object.keys(r);if(i)return Promise.all(i.map((function(o){var i=function(e){return!0===e[t]?e:null}(r[o]);return i?n(i.referenceTo).then((function(t){return r[o]=t,e(r[o],a+1)})):e(r[o],a+1)}))).then((function(){}))}return Promise.resolve()}(e,0)},Tt=function(e){var r={};return function(t,n){var o=t[e];if("string"!==typeof o)throw new Error("Property ".concat(e," is not a string"));r[n]=r[n]||{};var a=(0,w.Z)(ht()(o),(function(e){return!!r[n][e]}));return r[n][a]=!0,a}},Lt=g()("fs"),Mt=g()("path"),It=g()("@electron/remote"),Ut=It?It.dialog:null,Jt=function(e){return Lt?new Promise((function(r,t){Lt.readFile(e,{encoding:"utf8"},(function(n,o){if(n)return t(n);try{var a=JSON.parse(o);return r(a)}catch(i){return t(e+" is a corrupted/malformed file.")}}))})):Promise.reject("Filesystem is not supported.")},Wt=function(){if(!Ut)return Promise.reject("Not supported");var e=It.getCurrentWindow();return Ut.showOpenDialog(e,{title:"Open a project",properties:["openFile"],message:"If you want to open your GDevelop 4 project, be sure to save it as a .json file",filters:[{name:"GDevelop 5 project",extensions:["json"]}]}).then((function(e){var r=e.filePaths;return r&&r.length?{fileIdentifier:r[0]}:null}))},Bt=function(e){var r=e.fileIdentifier,t=Mt.dirname(r);return Jt(r).then((function(e){return At(e,{getReferencePartialObject:function(e){return Jt(Mt.join(t,e)+".json")},isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT",maxUnsplitDepth:3}).then((function(){return{content:e}}))}))},Gt=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.fileIdentifier,o=n+".autosave",!Lt.existsSync(o)){e.next=15;break}if(a=Lt.statSync(o).mtime.getTime(),t){e.next=6;break}return e.abrupt("return",a);case 6:return e.prev=6,i=Lt.statSync(n).mtime.getTime(),e.abrupt("return",a>i+5e3?a:null);case 11:return e.prev=11,e.t0=e.catch(6),console.error("Unable to compare *.autosave to project",e.t0),e.abrupt("return",null);case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[6,11]])})));return function(r,t){return e.apply(this,arguments)}}(),Ht=function(e){return Promise.resolve((0,n.Z)((0,n.Z)({},e),{},{fileIdentifier:e.fileIdentifier+".autosave"}))},zt=g()("fs-extra"),Kt=g()("path"),Xt=g()("@electron/remote"),Vt=Xt?Xt.dialog:null,Yt=["layouts","externalLayouts","externalEvents","eventsFunctionsExtensions"],Qt=function(e,r){var t=performance.now();return new Promise((function(n,o){zt.readFile(e,{encoding:"utf8"},(function(a,i){if(a)return o(a);""===i&&o(new Error("Written file is empty, did the write fail?")),i!==r&&o(new Error("Written file is not containing the expected content, did the write fail?"));var u=performance.now()-t;console.info("Verified ".concat(e," content in ").concat(u.toFixed(),"ms.")),n()}))}))},$t=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(zt){e.next=2;break}throw new Error("Filesystem is not supported.");case 2:if(""!==r){e.next=4;break}throw new Error("The content to save on disk is empty. Aborting.");case 4:return e.next=6,zt.ensureDir(Kt.dirname(t));case 6:return e.next=8,zt.writeFile(t,r);case 8:return e.next=10,Qt(t,r);case 10:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),qt=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=JSON.stringify(r,null,2),e.next=3,$t(n,t);case 3:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),en=function(e,r,t){var n,o=(0,Pt.XH)(e);if(e.isFolderProject()){var a=function(e,r){var t=r.pathSeparator,n=r.getArrayItemReferenceName,o=r.shouldSplit,a=r.isReferenceMagicPropertyName,i=[],u=function(e,r){var t;return i.push({reference:e,object:r}),t={},(0,U.Z)(t,a,!0),(0,U.Z)(t,"referenceTo",e),t};return function e(r,a,i){if(null!==r&&"object"===typeof r)if(Array.isArray(r))for(var s in r){var c=a+t+"*";if(o(c)){var l=r[s],p=n(l,i),f=i+t+p;r[s]=u(f,l),e(l,c,f)}else{var d=i+t+s;e(r[s],c,d)}}else for(var h in r){var v=a+t+h,m=i+t+h;if(o(v)){var g=r[h];r[h]=u(m,g),e(g,v,m)}else e(r[h],v,m)}}(e,"",""),i}(o,{pathSeparator:"/",getArrayItemReferenceName:Tt("name"),shouldSplit:(n=new Set(Yt.map((function(e){return"/".concat(e,"/*")}))),function(e){return n.has(e)}),isReferenceMagicPropertyName:"__REFERENCE_TO_SPLIT_OBJECT"});return Promise.all(a.map((function(e){return qt(e.object,Kt.join(t,e.reference)+".json").catch((function(e){throw console.error("Unable to write a partial file:",e),e}))}))).then((function(){return qt(o,r).catch((function(e){throw console.error("Unable to write the split project:",e),e}))}))}return qt(o,r).catch((function(e){throw console.error("Unable to write the project:",e),e}))},rn=function(e,r){var t=r.fileIdentifier,o=Date.now();if(!t)return Promise.reject('Project file is empty, "Save as" should have been called?');var a=(0,n.Z)((0,n.Z)({},r),{},{name:e.getName(),gameId:e.getProjectUuid(),lastModifiedDate:o}),i=Kt.dirname(t);return en(e,t,i).then((function(){return{wasSaved:!0,fileMetadata:a}}))},tn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.project,t=r.fileMetadata,n=t?t.fileIdentifier:"",o=Xt.getCurrentWindow(),a={defaultPath:n,filters:[{name:"GDevelop 5 project",extensions:["json"]}]},Vt){e.next=6;break}throw new Error("Unsupported");case 6:if(i=Vt.showSaveDialogSync(o,a)){e.next=9;break}return e.abrupt("return",{saveAsLocation:null});case 9:return e.abrupt("return",{saveAsLocation:{fileIdentifier:i}});case 10:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),nn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t,n){var o,a,i;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("A location was not chosen before saving as.");case 2:if(o=t.fileIdentifier){e.next=5;break}throw new Error("A file path was not chosen before saving as.");case 5:return n.onStartSaving(),a={fileIdentifier:o,name:r.getName(),gameId:r.getProjectUuid(),lastModifiedDate:Date.now()},e.next=9,n.onMoveResources({newFileMetadata:a});case 9:return i=Kt.dirname(o),r.setProjectFile(o),e.next=13,en(r,o,i);case 13:return e.abrupt("return",{wasSaved:!0,fileMetadata:a});case 14:case"end":return e.stop()}}),e)})));return function(r,t,n){return e.apply(this,arguments)}}(),on=function(e,r){var t=r.fileIdentifier+".autosave";return $t((0,Pt.h_)(e),t).catch((function(e){throw console.error("Unable to write ".concat(t,":"),e),e}))},an=function(e){return{id:"An error occurred when saving the project. Please try again by choosing another location."}},un=/\\ | \/ | : | \* | \? | " | < | > | \|/g,sn=/\s+/g,cn=function(e){var r=e.projectName,t=e.saveAsLocation,n=e.newProjectsDefaultFolder,o=t?Kt.dirname(t.fileIdentifier):n||"",a=r?function(e){return(e.length>200?e.substring(0,200):e).replace(un," ").replace(sn," ").trim()}(r)+".json":"game.json";return{fileIdentifier:Kt.join(o,a)}},ln=function(e){if(!Xt)return!1;var r=Xt.app.getPath("exe");if(!r)return!1;var t=Kt.dirname(r);return e.startsWith(t)},pn=t(78118),fn=o.memo((function(e){return(0,R.jsx)(pn.Z,(0,n.Z)((0,n.Z)({},e),{},{viewBox:"0 0 16 16",style:{fill:"none"},children:(0,R.jsx)("path",{d:"M5.75 11.25C5.75 11.25 6 14.25 4 15.25H12C10 14.25 10.25 11.25 10.25 11.25M5.75 11.25H13.25C14.3546 11.25 15.25 10.3546 15.25 9.25V2.75C15.25 1.64543 14.3546 0.75 13.25 0.75H2.75C1.64543 0.75 0.75 1.64543 0.75 2.75V9.25C0.75 10.3546 1.64543 11.25 2.75 11.25H5.75Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}))})),dn=t(18455),hn=t.g.gd,vn=cr("glob"),mn=g()("path"),gn=g()("@electron/remote"),xn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,l,f,d;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.project,n=r.extensions,o=r.createResource,a=vn()){e.next=4;break}return e.abrupt("return");case 4:return i=t.getResourcesManager(),u=mn.dirname(t.getProjectFile()),c=[].concat((0,p.Z)(n),(0,p.Z)(n.map((function(e){return e.toUpperCase()})))),e.prev=7,e.next=10,new Promise((function(e,r){a(u+"/**/*.{"+c.join(",")+"}",(function(t,n){t?r(t):e(n)}))}));case 10:l=e.sent,f=new hn.VectorString,l.forEach((function(e){return f.push_back(mn.relative(u,e))})),d=t.getResourcesManager().findFilesNotInResources(f),f.delete(),(0,dn.mapVector)(d,(function(e){var r=(0,w.Z)(e,(function(e){return i.hasResource(e)})),n=o();n.setFile(e),n.setName(r),(0,v.r3)(t,n),i.addResource(n),n.delete(),console.info('"'.concat(e,'" added to project as resource named "').concat(r,'".'))})),e.next=22;break;case 18:return e.prev=18,e.t0=e.catch(7),console.error("Error finding files inside ".concat(u,":"),e.t0),e.abrupt("return");case 22:case"end":return e.stop()}}),e,null,[[7,18]])})));return function(r){return e.apply(this,arguments)}}(),wn=t(71046),bn=t.n(wn),yn=t(85166),Pn=t.n(yn),jn=t(43734),kn=t.n(jn),Zn=g()("path"),Sn=g()("electron"),En=Sn?Sn.ipcRenderer:null,Fn=En&&Zn?function(e){var r=e.fileIdentifier,t=e.callback,n=e.options,o=Pn()(kn()((function(){return bn()((function(e){var r=Zn.relative(a,e).replace(/\\/g,"/");t({identifier:r})}),200,{leading:!1,trailing:!0})})),(function(e,r){return e(r)(r)})),a=Zn.dirname(r),i=Zn.basename(r),u=i+".autosave";En.on("project-file-changed",(function(e,r){o(r)}));var s=["**/.DS_Store","**/.git/**",Zn.join(a,i),Zn.join(a,u)];n&&n.isProjectSplitInMultipleFiles&&s.push.apply(s,(0,p.Z)(Yt.map((function(e){return Zn.join(a,e,"*.json")}))));var c=En.invoke("local-filesystem-watcher-setup",a,JSON.stringify({ignore:s}));return function(){En.removeAllListeners("project-file-changed"),c.then((function(e){En.invoke("local-filesystem-watcher-disable",e)}))}}:void 0,Dn={internalName:"LocalFile",name:{id:"Your computer"},renderIcon:function(e){return(0,R.jsx)(fn,{fontSize:e.size})},getFileMetadataFromAppArguments:function(e){return e[i.rM]&&e[i.rM].length?{fileIdentifier:e[i.rM][0]}:null},getProjectLocation:cn,renderNewProjectSaveAsLocationChooser:function(e){var r=e.projectName,t=e.saveAsLocation,n=e.setSaveAsLocation,o=e.newProjectsDefaultFolder,a=cn({projectName:r,saveAsLocation:t,newProjectsDefaultFolder:o});return(0,R.jsx)(Te.Z,{fullWidth:!0,value:Kt.dirname(a.fileIdentifier),onChange:function(e){var t=Kt.join(e,Kt.basename(a.fileIdentifier));n(cn({projectName:r,saveAsLocation:{fileIdentifier:t},newProjectsDefaultFolder:o}))},type:"create-game"})},setupResourcesWatcher:Fn,createOperations:function(){return{onOpenWithPicker:Wt,onOpen:Bt,getAutoSaveCreationDate:Gt,onSaveProject:rn,onChooseSaveProjectAsLocation:tn,onSaveProjectAs:nn,onAutoSaveProject:on,onGetAutoSave:Ht,getOpenErrorMessage:function(e){return{id:"Check that the file exists, that this file is a proper game created with GDevelop and that you have the authorization to open it."}},getWriteErrorMessage:an,canFileMetadataBeSafelySaved:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.fileIdentifier,!ln(n)){e.next=4;break}return e.next=4,t.showAlert({title:{id:"Choose another location"},message:{id:"Your project is saved in the same folder as the application. This folder will be deleted when the application is updated. Please choose another location if you don't want to lose your project."}});case 4:return e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),canFileMetadataBeSafelySavedAs:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.fileIdentifier,!ln(n)){e.next=5;break}return e.next=4,t.showAlert({title:{id:"Choose another location"},message:{id:"Your project is saved in the same folder as the application. This folder will be deleted when the application is updated. Please choose another location if you don't want to lose your project."}});case 4:return e.abrupt("return",!1);case 5:return e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}()}},createResourceOperations:function(){return function(e){var r=e.project,t=e.resource,n=e.i18n,o=e.updateInterface,a=e.cleanUserSelectionOfResources,i=e.informUser;return[{label:n._({id:"Locate file"}),click:function(){return function(e){var r=e.project,t=e.resource,n=(0,v.U3)(r,t.getName());gn.shell.showItemInFolder(mn.resolve(n))}({project:r,resource:t})}},{label:n._({id:"Open file"}),click:function(){return function(e){var r=e.project,t=e.resource,n=(0,v.U3)(r,t.getName());gn.shell.openPath(mn.resolve(n))}({project:r,resource:t})}},{label:n._({id:"Copy file path"}),click:function(){!function(e){var r=e.project,t=e.resource,n=(0,v.U3)(r,t.getName());gn.clipboard.writeText(mn.resolve(n))}({project:r,resource:t}),i({message:(0,R.jsx)(f.Trans,{id:"Resource file path copied to clipboard"})})}},{type:"separator"},{label:n._({id:"Scan in the project folder for..."}),submenu:d.Q.map((function(e){var t=e.displayName,a=e.fileExtensions,i=e.createNewResource;return{label:n._(t),click:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(){return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xn({project:r,extensions:a,createResource:i});case 2:o();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}))},{label:n._({id:"Remove resources with invalid path"}),click:function(){!function(e){var r=e.project,t=r.getResourcesManager();t.getAllResourceNames().toJSArray().filter((function(e){return"error"===(0,v.iz)(r,e)})).forEach((function(e){t.removeResource(e),console.info("Removed due to invalid path: "+e)}))}({project:r}),a(),o()}}]}}},Cn=g()("electron"),On=Cn?Cn.ipcRenderer:null,_n=function(){var e=o.useContext(tt.ZP).values.useGDJSDevelopmentWatcher;return o.useEffect((function(){if(e){if(On)return On.send("setup-local-gdjs-development-watcher"),function(){On.send("close-local-gdjs-development-watcher")};console.error("Unable to find ipcRenderer to set up GDJS development watchers")}}),[e]),null},Rn=t(32438),Nn=t(8018),An=t(38428),Tn=t.n(An),Ln=t(997),Mn=t(36465),In=t(84140),Un=t(72702),Jn=t(34517),Wn=t(14446),Bn=t.n(Wn),Gn=g()("electron"),Hn=Gn?Gn.ipcRenderer:null,zn=g()("fs-extra"),Kn=g()("path"),Xn=function(e,r,t){var n=Kn.extname(t),o=Kn.basename(t,n),a=(0,w.Z)(o,(function(t){var o=Kn.join(e,t)+n;return zn.existsSync(o)||r.has(o)}));return Kn.join(e,a)+n},Vn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Hn){e.next=2;break}throw new Error("Not supported");case 2:return e.next=4,Bn().get(r,{responseType:"arraybuffer"});case 4:return n=e.sent,o=n.data,e.next=8,Hn.invoke("local-file-save-from-arraybuffer",o,t);case 8:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),Yn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,p,f,d,h,m,g;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.project,n=r.fileMetadata,o=r.onProgress,a=r.authenticatedUser,zn&&Hn){e.next=3;break}throw new Error("Unsupported");case 3:return i=t.getResourcesManager(),u=i.getAllResourceNames().toJSArray(),c=u.filter((function(e){var r=i.getResource(e).getFile();return(0,v.PX)(r)})),e.next=8,(0,Mn._w)({authenticatedUser:a,allResourcePaths:c.map((function(e){return i.getResource(e).getFile()}))});case 8:return p=e.sent,f=Kn.dirname(n.fileIdentifier),d=Kn.join(f,"assets"),h=new Set,m=[],g=0,e.next=16,Tn().withConcurrency(50).for(c).process(function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,a,u,x,w,b,y;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.getResource(r),n=t.getFile(),!(0,v.PX)(n)){e.next=30;break}if(!(0,v.Gu)(n)){e.next=19;break}return e.prev=4,a=(0,v.OI)(t),u=a.localFilePath,x=a.extension,w=u?Kn.resolve(f,u):Xn(d,h,(0,Un.B)(t.getName()+(x||""))),e.next=9,zn.ensureDir(d);case 9:return e.next=11,Vn(n,w);case 11:t.setFile(Kn.relative(f,w).replace(/\\/g,"/")),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),m.push({resourceName:r,error:e.t0});case 17:e.next=30;break;case 19:return b=(0,Mn.bW)(n)?(0,Mn.jV)(n):(0,In.d0)(n)?(0,In.Lj)(n):(0,Jn.dh)(n),y=Xn(d,h,b),h.add(y),e.prev=22,e.next=25,(0,Ln.x)({times:2},(0,l.Z)((0,s.Z)().mark((function e(){var r,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zn.ensureDir(d);case 2:return r=new URL(n),(0,Mn.uG)(r.href)&&p&&r.searchParams.set("token",p),o=r.href,e.next=7,Hn.invoke("local-file-download",o,y);case 7:t.setFile(Kn.relative(f,y).replace(/\\/g,"/"));case 8:case"end":return e.stop()}}),e)}))));case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(22),m.push({resourceName:r,error:e.t1});case 30:o(g++,c.length);case 31:case"end":return e.stop()}}),e,null,[[4,14],[22,27]])})));return function(r){return e.apply(this,arguments)}}());case 16:return e.abrupt("return",{erroredResources:m});case 17:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Qn=t(10822),$n=t(85919),qn=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r,t){var n,o,a,i,u,c;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.transformItem,o=t.isChunkTooBig,a=t.processChunk,i=0,u=[];case 3:if(!(i<r.length)){e.next=20;break}return e.next=6,n(r[i]);case 6:if(c=e.sent,u.length){e.next=10;break}e.next=16;break;case 10:if(o([].concat(u,[c]))){e.next=13;break}e.next=16;break;case 13:return e.next=15,a(u);case 15:u.length=0;case 16:u.push(c),i++,e.next=3;break;case 20:if(!u.length){e.next=24;break}return e.next=23,a(u);case 23:u.length=0;case 24:return e.abrupt("return");case 25:case"end":return e.stop()}}),e)})));return function(r,t){return e.apply(this,arguments)}}(),eo=g()("path"),ro=g()("fs"),to=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){ro.readFile(r,(function(r,n){r?t(r):e(n)}))}));case 2:return t=e.sent,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),no={aac:"audio/aac",wav:"audio/wav",mp3:"audio/mp3",ogg:"audio/ogg",png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg",webp:"image/webp",ttf:"font/ttf",otf:"font/otf",mp4:"video/mp4",webm:"video/webm",json:"application/json",xml:"application/xml",gz:"application/gzip",js:"application/javascript"},oo=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,to(r);case 2:return t=e.sent,n=eo.extname(r).replace(/^\./,""),e.abrupt("return",new File([t],eo.basename(r),{type:no[n]||"application/octet-stream"}));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),ao=g()("path"),io=t.g.gd,uo=function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a,i,u,c,p,f,d,h;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.authenticatedUser,o=r.oldFileMetadata,a=r.newFileMetadata,i=r.onProgress,u={erroredResources:[]},c=a.fileIdentifier,p=t.getResourcesManager(),f=function(e){return p.getAllResourceNames().toJSArray().map((function(e){var r=p.getResource(e),t=r.getFile();return(0,v.PX)(t)?(0,$n.yk)(t)?null:(0,v.Gu)(t)?(u.erroredResources.push({resourceName:r.getName(),error:new Error("Unsupported blob URL.")}),null):null:r})).filter(Boolean)}(),d=ao.dirname(o.fileIdentifier),h=0,e.next=10,qn(f,{transformItem:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=ao.resolve(d,r.getFile()),e.prev=1,e.next=4,oo(t);case 4:return n=e.sent,e.abrupt("return",{resource:r,file:n});case 8:return e.prev=8,e.t0=e.catch(1),u.erroredResources.push({resourceName:r.getName(),error:new Error("Unable to open the file (".concat(t,")."))}),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(r){return e.apply(this,arguments)}}(),isChunkTooBig:function(e){return e.length>70||e.filter(Boolean).reduce((function(e,r){return e+r.file.size}),0)>15e7},processChunk:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.filter(Boolean),e.next=3,(0,Jn.LG)(n,c);case 3:return e.next=5,(0,Jn.ll)(n,c,t.map((function(e){return e.file})),(function(e,r){i(h+e,f.length)}));case 5:o=e.sent,h+=r.length,o.forEach((function(e,r){var n=e.url,o=e.error,a=t[r].resource;!o&&n?a.setFile(n):u.erroredResources.push({resourceName:a.getName(),error:o||new Error("Unknown error during upload.")})}));case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()});case 10:return e.abrupt("return",u);case 11:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),so=(_t={},(0,U.Z)(_t,"".concat(Dn.internalName,"=>").concat(Dn.internalName),function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.project,n=r.newFileMetadata,o=ao.dirname(n.fileIdentifier),a=Pe()(new io.AbstractFileSystemJS,new pe),io.ProjectResourcesCopier.copyAllResourcesTo(t,a,o,!0,!1,!0),e.abrupt("return",{erroredResources:[]});case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()),(0,U.Z)(_t,"".concat(Rn.Z.internalName,"=>").concat(Dn.internalName),(function(e){var r=e.project,t=e.newFileMetadata,n=e.onProgress,o=e.authenticatedUser;return Yn({project:r,fileMetadata:t,onProgress:n,authenticatedUser:o})})),(0,U.Z)(_t,"".concat(Nn.Z.internalName,"=>").concat(Dn.internalName),(function(e){var r=e.project,t=e.newFileMetadata,n=e.onProgress,o=e.authenticatedUser;return Yn({project:r,fileMetadata:t,onProgress:n,authenticatedUser:o})})),(0,U.Z)(_t,"".concat(Dn.internalName,"=>").concat(Rn.Z.internalName),uo),(0,U.Z)(_t,"".concat(Rn.Z.internalName,"=>").concat(Rn.Z.internalName),Qn.G),(0,U.Z)(_t,"".concat(Nn.Z.internalName,"=>").concat(Rn.Z.internalName),Qn.G),_t),co={moveAllProjectResources:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.oldStorageProvider,n=r.newStorageProvider,o=so["".concat(t.internalName,"=>").concat(n.internalName)]){e.next=4;break}throw new Error("Can't find a ResourceMover for ".concat(t.internalName," to ").concat(n.internalName,"."));case 4:return e.abrupt("return",o(r));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},lo=co,po=t(58271),fo=t(527),ho=(Rt={},(0,U.Z)(Rt,Rn.Z.internalName,fo.f),(0,U.Z)(Rt,Dn.internalName,Yn),(0,U.Z)(Rt,Nn.Z.internalName,po.j),Rt),vo={fetchAllProjectResources:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.storageProvider,n=ho[t.internalName]){e.next=4;break}throw new Error("Can't find a ResourceFetcher for ".concat(t.internalName," - have you registered the storage provider here?"));case 4:return e.abrupt("return",n(r));case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()},mo=vo,go=t(71445),xo=t(1333),wo=t(23236),bo=i.ZP.isDev(),yo=function(){function e(r){(0,q.Z)(this,e),this.auth=r}return(0,ee.Z)(e,[{key:"loginWithEmailAndPassword",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.email,n=r.password,e.prev=1,e.next=4,(0,go.e5)(this.auth,t,n);case 4:e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(1),console.error("Error while login:",e.t0),e.t0;case 10:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(r){return e.apply(this,arguments)}}()},{key:"loginOrSignupWithProvider",value:function(){var e=(0,l.Z)((0,s.Z)().mark((function e(r){var t,n,o,a=this;return(0,s.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.provider,!(n=r.signal)||!n.aborted){e.next=3;break}return e.abrupt("return",Promise.reject(new wo.s("Login or Signup with provider already aborted.")));case 3:return o=new Promise((function(e,r){n&&n.addEventListener("abort",(function(){(0,xo.g)(),r(new wo.s("Login or Signup with provider already aborted."))})),(0,xo.T)({onConnectionEstablished:function(e){if(!n||!n.aborted){var r=new URL("https://auth.gdevelop.io");r.searchParams.set("connection-id",e),r.searchParams.set("provider",t),r.searchParams.set("env",bo?"dev":"live"),i.ZP.openExternalURL(r.toString())}},onTokenReceived:function(){var t=(0,l.Z)((0,s.Z)().mark((function t(o){var i,u,c;return(0,s.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=o.provider,u=o.data,!n||!n.aborted){t.next=3;break}return t.abrupt("return");case 3:return t.prev=3,c="google"===i?go.hJ.credential(u.credential):"github"===i?go.GH.credential(u.accessToken):new go.O4("apple.com").credential({idToken:u.id_token,nonce:u.raw_nonce}),t.next=7,(0,go.sB)(a.auth,c);case 7:e(),(0,xo.g)(),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(3),console.error("An error occurred while logging in with ".concat(i," token:"),t.t0),r(t.t0);case 15:case"end":return t.stop()}}),t,null,[[3,11]])})));return function(e){return t.apply(this,arguments)}}(),onError:function(e){n&&n.aborted||((0,xo.g)(),console.error("An error occurred while setting up authentication web socket:",e),r(new Error("An error occurred while setting up authentication web socket.")))},onTimeout:function(){n&&n.aborted||((0,xo.g)(),console.error("Connection to authorization websocket timed out."),r(new Error("Connection to authorization websocket timed out.")))}})})),e.abrupt("return",o);case 5:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}()}]),e}(),Po=yo,jo=t.g.gd,ko=function(e){i.ZP.setUpContextMenu();var r=new Po(e.auth);e.setLoginProvider(r);var t=i.ZP.getArguments(),o=i.ZP.isDev();return(0,R.jsx)(yt.Z,{authentication:e,disableCheckForUpdates:!!t["disable-update-check"],makeEventsFunctionCodeWriter:xt,eventsFunctionsExtensionWriter:Et,eventsFunctionsExtensionOpener:Ot,children:function(e){var r=e.i18n;return(0,R.jsx)(Nt.Z,{appArguments:t,storageProviders:[Dn,Nn.Z,Rn.Z],defaultStorageProvider:Dn,children:function(e){var t=e.getStorageProviderOperations,i=e.getStorageProviderResourceOperations,s=e.storageProviders,c=e.initialFileMetadataToOpen,l=e.getStorageProvider;return(0,R.jsx)(a.Z,{i18n:r,renderMainMenu:function(e,r,t){return(0,R.jsx)(lt,{props:e,callbacks:r,extraCallbacks:t})},renderPreviewLauncher:function(e,r){return(0,R.jsx)(Ae,(0,n.Z)((0,n.Z)({},e),{},{ref:r}))},renderShareDialog:function(e){return(0,R.jsx)(u.Z,{project:e.project,onSaveProject:e.onSaveProject,isSavingProject:e.isSavingProject,onChangeSubscription:e.onChangeSubscription,onClose:e.onClose,automatedExporters:$r,manualExporters:qr,onlineWebExporter:Qr,fileMetadata:e.fileMetadata,storageProvider:e.storageProvider,initialTab:e.initialTab})},renderGDJSDevelopmentWatcher:o?function(){return(0,R.jsx)(_n,{})}:null,storageProviders:s,resourceMover:lo,resourceFetcher:mo,getStorageProviderOperations:t,getStorageProviderResourceOperations:i,getStorageProvider:l,resourceSources:I,resourceExternalEditors:$,extensionsLoader:ft()({gd:jo,objectsEditorService:wt.Z,objectsRenderingService:bt.Z,filterExamples:!o}),initialFileMetadataToOpen:c})}})}})}},82790:function(e,r,t){var n=t(89990),o=t(98033);function a(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}a.prototype=n(o.prototype),a.prototype.constructor=a,e.exports=a},85539:function(e,r,t){var n=t(89990),o=t(98033);function a(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=void 0}a.prototype=n(o.prototype),a.prototype.constructor=a,e.exports=a},98033:function(e){e.exports=function(){}},26019:function(e,r,t){var n=t(82115),o=t(59643),a=o?function(e,r){return o.set(e,r),e}:n;e.exports=a},70242:function(e){var r=Math.max;e.exports=function(e,t,n,o){for(var a=-1,i=e.length,u=n.length,s=-1,c=t.length,l=r(i-u,0),p=Array(c+l),f=!o;++s<c;)p[s]=t[s];for(;++a<u;)(f||a<i)&&(p[n[a]]=e[a]);for(;l--;)p[s++]=e[a++];return p}},68659:function(e){var r=Math.max;e.exports=function(e,t,n,o){for(var a=-1,i=e.length,u=-1,s=n.length,c=-1,l=t.length,p=r(i-s,0),f=Array(p+l),d=!o;++a<p;)f[a]=e[a];for(var h=a;++c<l;)f[h+c]=t[c];for(;++u<s;)(d||a<i)&&(f[h+n[u]]=e[a++]);return f}},40088:function(e){e.exports=function(e,r){for(var t=e.length,n=0;t--;)e[t]===r&&++n;return n}},96172:function(e,r,t){var n=t(60094),o=t(95336);e.exports=function(e,r,t){var a=1&r,i=n(e);return function r(){return(this&&this!==o&&this instanceof r?i:e).apply(a?t:this,arguments)}}},60094:function(e,r,t){var n=t(89990),o=t(72471);e.exports=function(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var t=n(e.prototype),a=e.apply(t,r);return o(a)?a:t}}},28957:function(e,r,t){var n=t(24864),o=t(60094),a=t(92133),i=t(98928),u=t(51765),s=t(44633),c=t(95336);e.exports=function(e,r,t){var l=o(e);return function o(){for(var p=arguments.length,f=Array(p),d=p,h=u(o);d--;)f[d]=arguments[d];var v=p<3&&f[0]!==h&&f[p-1]!==h?[]:s(f,h);return(p-=v.length)<t?i(e,r,a,o.placeholder,void 0,f,v,void 0,void 0,t-p):n(this&&this!==c&&this instanceof o?l:e,this,f)}}},92133:function(e,r,t){var n=t(70242),o=t(68659),a=t(40088),i=t(60094),u=t(98928),s=t(51765),c=t(70631),l=t(44633),p=t(95336);e.exports=function e(r,t,f,d,h,v,m,g,x,w){var b=128&t,y=1&t,P=2&t,j=24&t,k=512&t,Z=P?void 0:i(r);return function S(){for(var E=arguments.length,F=Array(E),D=E;D--;)F[D]=arguments[D];if(j)var C=s(S),O=a(F,C);if(d&&(F=n(F,d,h,j)),v&&(F=o(F,v,m,j)),E-=O,j&&E<w){var _=l(F,C);return u(r,t,e,S.placeholder,f,F,_,g,x,w-E)}var R=y?f:this,N=P?R[r]:r;return E=F.length,g?F=c(F,g):k&&E>1&&F.reverse(),b&&x<E&&(F.length=x),this&&this!==p&&this instanceof S&&(N=Z||i(N)),N.apply(R,F)}}},36342:function(e,r,t){var n=t(24864),o=t(60094),a=t(95336);e.exports=function(e,r,t,i){var u=1&r,s=o(e);return function r(){for(var o=-1,c=arguments.length,l=-1,p=i.length,f=Array(p+c),d=this&&this!==a&&this instanceof r?s:e;++l<p;)f[l]=i[l];for(;c--;)f[l++]=arguments[++o];return n(d,u?t:this,f)}}},98928:function(e,r,t){var n=t(19692),o=t(43050),a=t(14784);e.exports=function(e,r,t,i,u,s,c,l,p,f){var d=8&r;r|=d?32:64,4&(r&=~(d?64:32))||(r&=-4);var h=[e,r,u,d?s:void 0,d?c:void 0,d?void 0:s,d?void 0:c,l,p,f],v=t.apply(void 0,h);return n(e)&&o(v,h),v.placeholder=i,a(v,e,r)}},11304:function(e,r,t){var n=t(26019),o=t(96172),a=t(28957),i=t(92133),u=t(36342),s=t(29476),c=t(85682),l=t(43050),p=t(14784),f=t(96120),d=Math.max;e.exports=function(e,r,t,h,v,m,g,x){var w=2&r;if(!w&&"function"!=typeof e)throw new TypeError("Expected a function");var b=h?h.length:0;if(b||(r&=-97,h=v=void 0),g=void 0===g?g:d(f(g),0),x=void 0===x?x:f(x),b-=v?v.length:0,64&r){var y=h,P=v;h=v=void 0}var j=w?void 0:s(e),k=[e,r,t,h,v,y,P,m,g,x];if(j&&c(k,j),e=k[0],r=k[1],t=k[2],h=k[3],v=k[4],!(x=k[9]=void 0===k[9]?w?0:e.length:d(k[9]-b,0))&&24&r&&(r&=-25),r&&1!=r)Z=8==r||16==r?a(e,r,x):32!=r&&33!=r||v.length?i.apply(void 0,k):u(e,r,t,h);else var Z=o(e,r,t);return p((j?n:l)(Z,k),e,r)}},29476:function(e,r,t){var n=t(59643),o=t(78691),a=n?function(e){return n.get(e)}:o;e.exports=a},40411:function(e,r,t){var n=t(66130),o=Object.prototype.hasOwnProperty;e.exports=function(e){for(var r=e.name+"",t=n[r],a=o.call(n,r)?t.length:0;a--;){var i=t[a],u=i.func;if(null==u||u==e)return i.name}return r}},51765:function(e){e.exports=function(e){return e.placeholder}},98069:function(e){var r=/\{\n\/\* \[wrapped with (.+)\] \*/,t=/,? & /;e.exports=function(e){var n=e.match(r);return n?n[1].split(t):[]}},26096:function(e){var r=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var n=t.length;if(!n)return e;var o=n-1;return t[o]=(n>1?"& ":"")+t[o],t=t.join(n>2?", ":" "),e.replace(r,"{\n/* [wrapped with "+t+"] */\n")}},19692:function(e,r,t){var n=t(82790),o=t(29476),a=t(40411),i=t(20965);e.exports=function(e){var r=a(e),t=i[r];if("function"!=typeof t||!(r in n.prototype))return!1;if(e===t)return!0;var u=o(t);return!!u&&e===u[0]}},85682:function(e,r,t){var n=t(70242),o=t(68659),a=t(44633),i="__lodash_placeholder__",u=128,s=Math.min;e.exports=function(e,r){var t=e[1],c=r[1],l=t|c,p=l<131,f=c==u&&8==t||c==u&&256==t&&e[7].length<=r[8]||384==c&&r[7].length<=r[8]&&8==t;if(!p&&!f)return e;1&c&&(e[2]=r[2],l|=1&t?0:4);var d=r[3];if(d){var h=e[3];e[3]=h?n(h,d,r[4]):d,e[4]=h?a(e[3],i):r[4]}return(d=r[5])&&(h=e[5],e[5]=h?o(h,d,r[6]):d,e[6]=h?a(e[5],i):r[6]),(d=r[7])&&(e[7]=d),c&u&&(e[8]=null==e[8]?r[8]:s(e[8],r[8])),null==e[9]&&(e[9]=r[9]),e[0]=r[0],e[1]=l,e}},59643:function(e,r,t){var n=t(74058),o=n&&new n;e.exports=o},66130:function(e){e.exports={}},70631:function(e,r,t){var n=t(56954),o=t(37934),a=Math.min;e.exports=function(e,r){for(var t=e.length,i=a(r.length,t),u=n(e);i--;){var s=r[i];e[i]=o(s,t)?u[s]:void 0}return e}},44633:function(e){var r="__lodash_placeholder__";e.exports=function(e,t){for(var n=-1,o=e.length,a=0,i=[];++n<o;){var u=e[n];u!==t&&u!==r||(e[n]=r,i[a++]=n)}return i}},43050:function(e,r,t){var n=t(26019),o=t(47612)(n);e.exports=o},14784:function(e,r,t){var n=t(98069),o=t(26096),a=t(79584),i=t(62930);e.exports=function(e,r,t){var u=r+"";return a(e,o(u,i(n(u),t)))}},62930:function(e,r,t){var n=t(85218),o=t(24103),a=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,r){return n(a,(function(t){var n="_."+t[0];r&t[1]&&!o(e,n)&&e.push(n)})),e.sort()}},38188:function(e,r,t){var n=t(82790),o=t(85539),a=t(56954);e.exports=function(e){if(e instanceof n)return e.clone();var r=new o(e.__wrapped__,e.__chain__);return r.__actions__=a(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}},2766:function(e,r,t){var n=t(77820),o=t(11304),a=t(51765),i=t(44633),u=n((function(e,r){var t=i(r,a(u));return o(e,32,void 0,r,t)}));u.placeholder={},e.exports=u},85166:function(e,r,t){var n=t(81173),o=t(2766);e.exports=function(e,r){return o(n(r),e)}},20965:function(e,r,t){var n=t(82790),o=t(85539),a=t(98033),i=t(99103),u=t(71591),s=t(38188),c=Object.prototype.hasOwnProperty;function l(e){if(u(e)&&!i(e)&&!(e instanceof n)){if(e instanceof o)return e;if(c.call(e,"__wrapped__"))return s(e)}return new o(e)}l.prototype=a.prototype,l.prototype.constructor=l,e.exports=l}}]);
//# sourceMappingURL=local-app.6316a81d.chunk.js.map